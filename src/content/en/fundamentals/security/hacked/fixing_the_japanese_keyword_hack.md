project_path: /web/fundamentals/_project.yaml
book_path: /web/fundamentals/_book.yaml

{# wf_updated_on: 2018-02-12 #}
{# wf_published_on: 2015-01-01 #}
{# wf_blink_components: N/A #}

# Fixing the Japanese keyword hack {: .page-title }

Note: Unsure whether or not your site is hacked? Start by reading our
[how to check if your site is hacked](how_do_I_know_if_site_hacked) guide.

This guide is created specifically for a type of hack that creates
autogenerated Japanese text to your site which we’ll refer to as the
Japanese keyword hack. It’s designed for users of popular
[Content Management Systems (CMSs)](https://en.wikipedia.org/wiki/Web_content_management_system#Notable_web_CMS),
but you’ll find this guide useful even if you don’t use a CMS.

We want to make sure this guide is really helpful to you. Please
[leave feedback](https://docs.google.com/a/google.com/forms/d/12iF45BaZuEgwn29A7DOW73rd1Hi_7NiAHCFWB3zMu0U/viewform)
to help us improve!


## Identifying this type of hack {: #identifying }

<img src="images/JapaneseKeywordHackExamplePage.png" class="attempt-right">

The Japanese keywords hack typically creates new pages with autogenerated
Japanese text on your site in randomly generated directory names
(for instance, http://example.com/ltjmnjp/341.html). These pages are
monetized using affiliate links to stores selling fake brand merchandise
and then shown in Google search. Here’s an example of what one of these pages look like:

With this type of hack, the hacker will typically add themselves as a
property owner in Search Console, in order to increase profits by
manipulating your site’s settings like geotargeting or sitemaps.
If you’ve received a notification that someone you don’t know has
verified your site in [Search Console](https://www.google.com/webmasters/tools/),
there’s a strong possibility that your site has been hacked.

<img src="images/JapaneseKeywordHackExampleSearch.png" class="attempt-right">

<<_fixing-identify.md>>


## Fixing the hack {: #fixing }

<<_fixing-fixing-intro.md>>

### Remove newly created accounts from Search Console

If a new owner you don’t recognize has been added to your Search Console
account, revoke their access as soon as possible. You can check which users
are verified for your site on the
[Search Console verification page](https://www.google.com/webmasters/verification).
Click on "Verification Details" for the site to view all verified users.

To remove an owner from Search Console, read through the Remove Owner
section of the
[Managing users, owners, and permissions Help Center](https://support.google.com/webmasters/answer/2453966).
You’ll need to remove the associated verification token which is typically
either an HTML file on the root of your site or a dynamically generated
`.htaccess` file mimicking an HTML file.

If you are unable to find an HTML verification token on your site,
check for a rewrite rule in your `.htaccess` file. The rewrite rule
will look similar to this:

    RewriteEngine On
      RewriteRule ^google(.*)\.html$ dir/file.php?google=$1 [L]

Note: You can typically check if you’ve successfully removed a dynamically
generated verification token by navigating to a simulated verification
token file like `wwww.example.com/google[random number and letters].html`.
For example, if your site is www.brandonsbaseballcards.com, try navigating
to www.brandonsbaseballcards.com/google1234.html. If that page returns a
HTTP 404, then the dynamically generated verification token is likely fixed.

To remove the dynamically generated verification token from your
`.htaccess` file, follow the steps below.

### Check your `.htaccess` file (2 steps)

Aside from using a `.htaccess` file to create dynamically generated
verification tokens, hackers often use `.htaccess` rules to redirect
users or create gibberish spammy pages. Unless you have custom
`.htaccess` rules, consider replacing your `.htaccess` with a
completely new copy.

#### Step 1

<<_fixing-htaccess-locate.md>>

#### Step 2

<<_fixing-htaccess-replace.md>>

### Remove All Malicious Files and Scripts (4 steps)

<<_fixing-find-remove-intro.md>>

**Step 1**

<<_fixing-reinstall-cms.md>>

**Step 2**

Hackers will often modify your sitemap or add a new sitemaps to help get their
URLs indexed more quickly. If you previously had a sitemap file, check the
file for any suspicious links and remove them from your sitemap. If
there are any sitemap files you don’t remember adding to your site,
double check them and remove them if they only contain spammy URLs.

**Step 3**

<<_fixing-additional-files.md>>

**Step 4**

<<_fixing-scan-files-intro.md>>

Scan through the suspicious files you’ve already identified to look
for blocks of obfuscated code. This might look like a combination of
seemingly jumbled letters and numbers. The obfuscated code is usually
preceded by a combination of PHP functions like `base64_decode`, `rot13`,
`eval`, `strrev`, `gzinflate`. Here is an example of what the block of code
might look like. Sometimes all this code will be stuffed into one long line
of text, making it look smaller than it actually is.

    $O_O0O_O0_0=urldecode("%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70
    %78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A");
    $OO0_0OO0__=$O_O0O_O0_0{26}.$O_O0O_O0_0{6}.$O_O0O_O0_0{10}.$O_O0O_O0_0{30}

<<_fixing-check-if-site-is-clean.md>>

<<_fixing-prevent.md>>

<<_fixing-additional-resources.md>>
