project_path: /web/_project.yaml
book_path: /web/updates/_book.yaml
description: Add service worker-powered offline capabilities to your site with the sw-precache module.


{# wf_updated_on: 2019-03-16 #}
{# wf_published_on: 2015-02-22 #}
{# wf_tags: news,serviceworker,offline,cache,performance #}
{# wf_blink_components: N/A #}

# Offline-first, fast, with the sw-precache module {: .page-title }

{% include "web/_shared/contributors/jeffposnick.html" %}


You can’t [read about service workers](/web/fundamentals/getting-started/primers/service-workers)
without getting excited—they’re the behind-the-scenes infrastructure that make
it possible for web <em>pages</em> to act more like web <em>applications</em>. Upcoming web platform features
like [background sync](https://www.chromestatus.com/feature/6170807885627392)
and [push notifications](https://www.chromestatus.com/feature/5416033485586432)
will rely on service workers, and following the
[release of Chrome 40](https://blog.chromium.org/2014/12/chrome-40-beta-powerful-offline-and.html),
service worker-based caching is available to use today. If you’ve wanted to add service worker-powered
offline support to your sites, but weren’t sure how to get started, the
<strong><code><a href="https://github.com/jeffposnick/sw-precache">sw-precache</a></code></strong>
module is for you! <code>sw-precache</code> hooks into your existing <code>node</code>-based build
process (e.g. <code><a href="https://gulpjs.com/">Gulp</a></code> or
<code><a href="https://gruntjs.com/">Grunt</a></code>) and generates a list of versioned resources,
along with the service worker code needed to precache them. Your site can start working offline and
load faster even while online, by virtue of caching.

The service worker generated by <code>sw-precache</code> will cache and serve the resources that you
configure as part of your build process. For smaller, mostly static sites, you can have it precache
every image, HTML, JavaScript, and CSS file that makes up your site. Everything will both work
offline, and load fast on subsequent visits without any extra effort. For sites with lots of
dynamic content, or many large images that aren’t always needed, precaching a
“skeleton” subset of your site often makes the most sense. You can combine <code>sw-precache</code> with one
of the [service worker “recipes”](https://github.com/GoogleChrome/samples/tree/gh-pages/service-worker) or
techniques outlined in the [offline cookbook](https://jakearchibald.com/2014/offline-cookbook/) to provide a
robust offline experience with sensible fallbacks—e.g. when a
large, uncached image is requested offline, serve up a smaller, cached
placeholder image instead.

Because <code>sw-precache</code> integrates into your site’s build process, you can use
[wildcards](https://github.com/isaacs/node-glob) to precache <em>all</em> of the resources that match a
pattern—there’s no list of files or URLs that
you have to manually keep up to date. What’s more, the module automatically
versions all your cached resources based on a hash of each file’s contents.
When a change to any file is detected as part of your build process, the
generated service worker knows to expire the old version and fetch the new
version of the resource. All of the cache entries that remain the same are
left untouched.

Here’s a basic example of using <code>sw-precache</code> as part of a <code>gulp</code> build:


    gulp.task('generate-service-worker', function(callback) {
      var path = require('path');
      var swPrecache = require('sw-precache');
      var rootDir = 'app';

      swPrecache.write(path.join(rootDir, 'service-worker.js'), {
        staticFileGlobs: [rootDir + '/**/*.{js,html,css,png,jpg,gif}'],
        stripPrefix: rootDir
      }, callback);
    });


You’ll see information about which resources will be precached, as well as the
total precache size as part of the task output:


    Starting 'generate-service-worker'...
    Caching static resource 'app/css/main.css' (65 B)
    Caching static resource 'app/images/one.png' (593 B)
    Caching static resource 'app/images/two.png' (641 B)
    Caching static resource 'app/index.html' (2.09 kB)
    Caching static resource 'app/js/a.js' (7 B)
    Caching static resource 'app/js/b.js' (7 B)
    Caching static resource 'app/js/service-worker-registration.js' (3.37 kB)
    Total precache size is about 6.77 kB for 7 resources.
    Finished 'generate-service-worker' after 14 ms


There’s a lot more information at the
[GitHub project page](https://github.com/jeffposnick/sw-precache), including a demo project with
<code><a href="https://github.com/jeffposnick/sw-precache/blob/master/demo/gulpfile.js">gulpfile.js</a></code> and
<code><a href="https://github.com/jeffposnick/sw-precache/blob/master/demo/Gruntfile.js">Gruntfile.js</a></code>
samples, and a
[script](https://github.com/jeffposnick/sw-precache/blob/master/demo/app/js/service-worker-registration.js)
you can use to register the generated service worker. If you’d like to see it
in action, just check out the recently launched
[Google I/O 2015 web app](https://events.google.com/io2015/){: .external }—thanks (in part) to
<code>sw-precache</code>, you can browse it at your leisure, online or off.


