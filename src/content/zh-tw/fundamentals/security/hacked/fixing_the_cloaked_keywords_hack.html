<html devsite><head>
  <title>修正偽裝的關鍵字和連結入侵問題</title>
  <meta name="project_path" value="/web/fundamentals/_project.yaml"/>
  <meta name="book_path" value="/web/fundamentals/_book.yaml"/>
<meta name="devsite_continuous_localization_fp" value="DGV7xNragN9HZ8y5MSlU2fxANYcQNA3KoE+YsYU0AtWHaYTDuDS8VMrRRGtvrq7FMcXWQdN5Hd3JAPNLQcUKrrvzQu5oWkLB+fiCoJN0cmoLMiYpjArW9nlDUh5Fd/tj3ANwnrHrtJgc3J1GP4EyxKrz+M3RfOj6o9TWwqB6UaE="></meta><meta name="devsite_continuous_localization_translatable_html_file_type" value="source"></meta></head>

<body>

<p>本指南旨在協助您處理所謂的亂字植入問題。顧名思義，遭到入侵的網站會出現充斥無意義關鍵字的網頁。<a href="https://en.wikipedia.org/wiki/Web_content_management_system#Notable_web_CMS" l10n-encrypted-href="fDAavPipNi3L7oKW173OnAOrZfK8qSBsW73e1nANJzBUmOWztsjdEWYvTckdpiUrlx3KV5JDmfAX78Sj/1rTByEHYmzohOA6JH22pQy1iU4=">各大內容管理系統</a> (CMS) 的使用者皆可參考本指南。不過，即使您並未使用 CMS，本指南仍提供了十分實用的資訊。</p>

<p><strong>注意：</strong>不確定您的網站是否遭到入侵嗎？首先請詳閱我們的<a href="/web/fundamentals/hacked/how_do_I_know_if_site_hacked">如何檢查網站是否遭到入侵</a>指南。</p>



<aside class="note">我們希望確定本指南確實對您有所幫助。歡迎<a href="https://docs.google.com/a/google.com/forms/d/12iF45BaZuEgwn29A7DOW73rd1Hi_7NiAHCFWB3zMu0U/viewform" l10n-encrypted-href="Y8CvmyoECzXwls/oZTNUPel6/rzBFIuQf3sSK+uodQZOqpR94XBJ+XibPywvk0+b9ezSGKvhi8xxpIK7uGXOCI2dMR8PtqMn9qLJh3QQBiqDN7SHduMZkPeGTm9uywje4+7KYcijq55wcC/P3SGriA==">提供意見</a>，協助我們讓指南內容更臻完善！</aside>

<h2>目錄</h2>

<ul>
<p></p><li><a href="#identifying" l10n-encrypted-href="i8ndmVX5d0ID8O9zoenvuw==">步驟 1：判別這類入侵行為</a></li><p></p>
<p></p><li><a href="#fixing" l10n-encrypted-href="E7jyI6Rsf8GvIQvlRXlhig==">步驟 2：修正入侵問題</a></li><p></p>
<p></p><li><a href="#resources" l10n-encrypted-href="thupmU05Hk4T+qZrFSNMSw==">步驟 3：其他資源</a></li><p></p>
<p></p><li><a href="/web/fundamentals/hacked/FAQs_for_hacked_sites">網站遭到入侵的常見問題</a></li><p></p>
</ul>

<a name="identifying"></a>
<h2>判別這類入侵行為</h2>

<p>偽裝關鍵字和連結入侵會自動產生許多包含無意義文字、連結\和圖片的網頁。這些網頁有時會含有原始網站的基本範本元素，所以乍看之下可能被誤當成目標網站的正確網頁，使用者需閱讀內容才會發現問題。</p>

<p>這類遭入侵網頁的建立目的是操縱 Google 的排名指標。駭客常試圖向其他第三方販售遭入侵網頁上的連結，藉此營利。此外，遭到入侵的網頁常會將訪客重新導向至不相關的網頁 (例如色情網站)，讓駭客從中牟利。</p>

<p>如要檢查這類問題，首先請使用 <a href="https://www.google.com/webmasters/tools/" l10n-encrypted-href="bnkUt+0jxHW5UePwiMjGHgSJUyK0ahq5p2Xo+yKO2LCoVUPePn2BCeqpvFwYJx5q">Search Console</a> 的<a href="https://www.google.com/webmasters/tools/security-issues" l10n-encrypted-href="wFaZwKx/FqCH4eQvAdZWPgSJUyK0ahq5p2Xo+yKO2LDoa3a6ko9L8TWTgkY4BqOep2DEtUsCy0Ve7mU772iG0Q==">安全性問題</a>工具查看 Google 是否在您的網站上找到任何這類遭到入侵的網頁。開啟 Google 搜尋視窗並輸入 <code class="notranslate l10n-notranslate">site:[your site]</code>，有時也能找出這類網頁。您網站上已經由 Google 建立索引的網頁都會顯示，包括遭到入侵的網頁。請瀏覽搜尋結果中的一些網頁，看看有無任何不尋常的網址。如果 Google 搜尋未顯示任何遭到入侵的內容，請使用其他搜尋引擎搜尋相同的字詞。其他搜尋引擎可能會顯示 Google 已從索引中移除的遭入侵內容。這類搜尋結果看起來通常是下面這樣子的：</p>


<img src="/web/fundamentals/security/hacked/images/CloakedKeywordHackExampleSearch.png" style="padding:0px 25px">

<p l10n-encrypted-style="/eDMjbcyQ8YpGjRJggEDIBQTTm7qpsvvmfgxV6fkusE=" style="padding:0px 25px"><strong>注意：</strong><em>這裡的搜尋結果包含許多不是由網站擁有者建立的網頁。如果您仔細觀察第二筆和第三筆搜尋結果的說明，就會看到這類入侵行為所植入的不相關文字。</em></p>

<p>當您造訪遭到入侵的網頁時，可能會看到表示網頁不存在的訊息 (例如 404 錯誤訊息)。請別上當！駭客會讓您以為遭到入侵的網頁已移除或已修正，製造網站沒有問題的假象。這種做法稱為<a href="//support.google.com/webmasters/answer/66355" l10n-encrypted-href="+MnmPhXLuMxD2VLFLngQ0KArGd6SuOrIdKNhJ8TAfI9BJHSzkBQAHlU9iNsiuhPw">偽裝</a>內容。請在 <a href="https://www.google.com/webmasters/tools/googlebot-fetch" l10n-encrypted-href="wFaZwKx/FqCH4eQvAdZWPgSJUyK0ahq5p2Xo+yKO2LAiz85uaQL1OSHmh9ZlIHN5PBF3nzIP4FICVwj1Kz6IHg==">Google 模擬器</a>工具中輸入您網站的網址，查看有無偽裝內容。Google 模擬器工具可讓您查看基本的隱藏內容。遭到入侵的網頁外觀可能如下：</p>

<img src="/web/fundamentals/security/hacked/images/CloakedKeywordHackExamplePage.png" style="padding:0px 25px">


<a name="fixing"></a>
<h2>修正入侵問題</h2>

<p>首先，請為所有要移除的檔案建立離線複本，再移除檔案，以免日後需要還原檔案。您甚至可以先備份整個網站，再開始執行清理程序。如要這麼做，請將位於您伺服器上的所有檔案儲存到其他位置，或是搜尋您的 CMS 專用的最佳備份做法。</p>

<h3>檢查 .htaccess 檔案 (3 個步驟)</h3>

<p>偽裝的關鍵字和連結入侵會使用您的 .htaccess 檔案，在您的網站上自動建立偽裝的網頁。您可以前往 Apache 官方網站，熟悉 <a href="https://httpd.apache.org/docs/current/howto/htaccess.html" l10n-encrypted-href="oxukPFo/pb0BlXrrDLS8MY7H/A2VvrDif6x7R0dUeR+8wuajVXML/gAzUrl+oK27sJoXxFM3eSyNYOSGo/0x9Q==">.htaccess 基礎知識</a>，進一步瞭解這類入侵行為對您的網站有何影響。</p>

<p><b>步驟 1</b></p>
<p>在您的網站上找出 .htaccess 檔案。如果您不確定所在位置，且您使用的是 WordPress、Joomla 或 Drupal 這類 CMS，請在搜尋引擎中使用「.htaccess 檔案位置」搭配您的 CMS 名稱進行搜尋。.htaccess 檔案數量可能不只一個 (因網站而異)。請以清單記錄所有 .htaccess 檔案位置。
</p>

<p><strong>注意：</strong>.htaccess 經常是「隱藏的檔案」。搜尋時請務必讓系統顯示所有隱藏的檔案。</p>


<p><b>步驟 2</b></p>
<p>開啟 .htaccess 檔案並查看內容。您應可在其中找出一行外觀大致如下的程式碼：</p>

<pre class="notranslate l10n-notranslate prettyprint">
  RewriteRule (.*cj2fa.*|^tobeornottobe$) /injected_file.php?q=$1 [L]
</pre>

<p>這行中的變數可能有所不同。「cj2fa」和「tobeornottobe」可能是任何字母或字詞組合。重要的是找出在這行中參照的 .php。</p>

<p>請記下 .htaccess 檔案中提到的 .php 檔案。範例中的 .php 檔案名稱為「injected_file.php」，但實際上的 .php 檔案名稱不會這麼顯眼，通常是隨機的一組無害字詞，例如「horsekeys.php」、「potatolake.php」等等。這很有可能就是後續需要追蹤並移除的惡意 .php 檔案。</p>

<div class="alert">在 .htaccess 中，並非所有含 RewriteRule 和 .php 檔案的行都是惡意程式碼。如果您不確定特定一行程式碼的功用，請前往<a href="https://support.google.com/webmasters/go/community" l10n-encrypted-href="5TGqX3BGnR1wDX3q2UuoUl8/1IcWIMZShUywi8+OFhFJD1Yl7IKG6D/z+YJGpyzQKhraDV8RTvPIa5MbSVtR/w==">網站管理員說明論壇</a>求助，請經驗豐富的網站管理員們協助您判斷。</div>

<p><b>步驟 3</b></p>
<p>使用沒有惡意內容或預設版本的 .htaccess 檔案取代所有 .htaccess 檔案。一般來說，如要尋找預設版本的 .htaccess 檔案，您可以使用「預設 .htaccess 檔案」搭配您的 CMS 名稱進行搜尋。如果您的網站有多個 .htaccess 檔案，請針對各個檔案找出沒有惡意內容的版本，再執行取代作業。</p>

<p>如果沒有預設的 .htaccess，且您未曾在網站上設定過 .htaccess 檔案，那麼您在網站上找到的 .htaccess 可能是惡意檔案。保險起見，請離線儲存 .htaccess 檔案複本，然後將 .htaccess 檔案從您的網站上刪除。</p>

<h3>找出其他惡意檔案並予以移除 (5 個步驟)</h3>

<p>判別惡意檔案不太容易，可能需要數小時。請耐心檢查檔案。如果您尚未備份網站上的檔案，這時可以順便進行備份。請透過 Google 搜尋「備份網站」和您的 CMS 名稱，尋找相關的操作說明。</p>

<p><b>步驟 1</b></p>
<p>如果您使用 CMS，請重新安裝預設 CMS 版本內含的所有核心 (預設) 檔案，以及您可能新增過的任何項目 (例如主題、模組、外掛程式)，以確保這些檔案完全沒有遭到入侵的內容。您可以透過 Google 搜尋「重新安裝」和您的 CMS 名稱，尋找重新安裝程序的相關操作說明。如果您有任何外掛程式、模組、擴充功能或主題，別忘了一併重新安裝這些項目。</p>

<div class="alert">重新安裝核心檔案會使您失去所有調整過的自訂設定。請務必先為資料庫和所有檔案建立備份，再重新安裝。</div>

<p><b>步驟 2</b></p>
<p>請先尋找您稍早在 .htaccess 檔案中找出的 PHP 檔案。根據您存取伺服器上檔案的方式，應可使用某些類型的搜尋功能。請搜尋惡意檔案名稱。如果找到的話，請先備份複本並儲存在其他位置 (以免日後需要還原)，再將惡意檔案從網站上刪除。</p>

<p><b>步驟 3</b></p>
<p>尋找有無遺留任何其他惡意或遭到入侵的檔案。您可能在前兩個步驟已經移除了所有惡意檔案，但最好還是執行後續幾步，以免網站上殘留其他遭到入侵的檔案。</p>

<p>請別誤以為您必須開啟每個 PHP 檔案並詳加檢視。首先請建立可疑的 PHP 檔案清單，列出您要調查的檔案。判別可疑的 PHP 檔案時，可以採用以下這些方法：</p><p>

</p><ul>
<li>如果您已重新載入 CMS 檔案，只需檢視不屬於預設 CMS 檔案或資料夾的檔案。這樣可以排除大多數的 PHP 檔案，只剩一些檔案需要檢視。</li>
<li>依上次修改日期排序您網站上的檔案，找出修改時間與您首次發現網站遭到入侵的時間相差不到幾個月的檔案。</li>
<li>依大小排序您網站上的檔案，找出所有特別大的檔案。</li>
</ul>

<p><b>步驟 4</b></p>
<p>建立可疑的 PHP 檔案清單後，即可檢查是正常檔案或惡意檔案。如果您對 PHP 不熟悉，可能需要花費更多時間，不妨先溫習一些 <a href="https://php.net/docs.php">PHP 說明文件</a>。不過，即使您是編寫程式碼的新手，仍可尋找一些有助於判別
惡意檔案的基本模式。</p>

<p>首先，請掃描您已找出的惡意檔案，找出像是雜亂的字母和數字組合的大段文字。這類大段文字前面通常有 PHP 函式組合，例如 base64_decode、 rot13、eval、strrev、gzinflate。這類程式碼區塊可能的外觀如下。有時這類程式碼會全部包進一長串文字，看起來比實際上更小。</p>


<pre class="notranslate l10n-notranslate prettyprint">
&lt;!--Hackers try to confuse webmasters by encoding malicious code into blocks of texts.
Be wary of unfamiliar code blocks like this.--&gt;

base64_decode(strrev("hMXZpRXaslmYhJXZuxWd2BSZ0l2cgknbhByZul2czVmckRWYgknYgM3ajFGd0FGIlJXd0Vn
ZgknbhBSbvJnZgUGdpNHIyV3b5BSZyV3YlNHIvRHI0V2Zy9mZgQ3Ju9GRg4SZ0l2cgIXdvlHI4lmZg4WYjBSdvlHIsU2c
hVmcnBydvJGblBiZvBCdpJGIhBCZuFGIl1Wa0BCa0l2dgQXdCBiLkJXYoBSZiBibhNGIlR2bjBycphGdgcmbpRXYjNXdmJ2b
lRGI5xWZ0Fmb1RncvZmbVBiLn5WauVGcwFGagM3J0FGa3BCZuFGdzJXZk5Wdg8GdgU3b5BicvZGI0xWdjlmZmlGZgQXagU2ah
1GIvRHIzlGa0BSZrlGbgUGZvNGIlRWaoByb0BSZrlGbgMnclt2YhhEIuUGZvNGIlxmYhRWYlJnb1BychByZulGZhJXZ1F3ch
1GIlR2bjBCZlRXYjNXdmJ2bgMXdvl2YpxWYtBiZvBSZjVWawBSYgMXagMXaoRFIskGS"));
</pre>

<p>有時這類程式碼並不雜亂，看起來就像普通程式碼。如果您不確定是否屬於惡意程式碼，請前往<a href="https://productforums.google.com/forum/#!forum/webmasters">網站管理員說明論壇</a>求助，請經驗豐富的網站管理員們協助您檢查檔案。</p>

<p><b>步驟 5</b></p>
<p>您現已瞭解哪些檔案屬於惡意檔案，請先建立備份或本機複本，將這些檔案儲存在電腦上 (以免後續發現並非惡意檔案)，再刪除所有惡意檔案。</p>

<h3>檢查網站是否沒有惡意內容</h3>

<p>清理完遭到入侵的檔案後，請檢查您的一番苦心是否奏效。還記得您稍早找到了一些充斥胡言亂語的網頁嗎？請再次使用 Google 模擬器檢查這些網頁，看看是否仍然存在。如果 Google 模擬器傳回「找不到」回應，表示您的網站應該沒問題了！</p>

<div class="tip">您也可以按照<a href="https://support.google.com/webmasters/troubleshooter/6155978" l10n-encrypted-href="L9cotzWz1Gz2EXZ4cybZUF8/1IcWIMZShUywi8+OFhFaf4PNa8lHkLSIkkiloXraU+YkdKmDgr9qSLhT4Aj5jg==">網站遭入侵疑難排解工具</a>中的步驟檢查您的網站上是否仍有遭到入侵的內容。</div>

<h2>如何避免再次遭到入侵？</h2>

<p>修正網站的安全性漏洞是修正網站問題的最後一步，也是重要的一步。最近的研究發現曾遭入侵的網站中有 20% 會在 1 天內再次遭到入侵。因此，確切瞭解網站遭到入侵的方式實在很有幫助。請詳閱<a href="/web/fundamentals/security/hacked/top_ways_websites_get_hacked_by_spammers">垃圾內容發佈者入侵網站的常見方式</a>指南，針對安全性漏洞展開調查。不過，如果您無法找出網站遭到入侵的方式，請參考以下檢查清單，瞭解可有效減少網站安全性漏洞的一些做法：</p>

<ul>
<li>定期更新 CMS、外掛程式、擴充功能和模組：希望您已經完成這個步驟。許多網站正是因為執行的軟體版本過舊而遭到入侵。部分 CMS 支援自動更新功能。</li>
<li>定期掃描電腦：任選各大病毒掃描工具，檢查有無病毒或安全性漏洞。</li>
<li>定期變更關鍵字：定期變更您所有網站帳戶 (例如代管服務供應商、FTP 和 CMS) 的密碼可防止他人在未經授權的情況下存取您的網站。請務必為每個帳戶建立非重複的高強度密碼。</li>
<li>使用<a href="https://en.wikipedia.org/wiki/Two-factor_authentication" l10n-encrypted-href="9xQhRBOSn9SmNcpVG2sojwOrZfK8qSBsW73e1nANJzDifCX+gGFDlLulOI0L7gbBir3zffj4Scth1kJJ0GCu7g==">雙重驗證 (2FA)</a>：建議您為所有要求您登入的服務啟用 2FA。這樣一來，即使駭客成功竊取您的密碼，仍然不易冒用您的身分登入。</li>
<li>考慮訂閱安全性服務，協助您監控網站：有許多優質服務可協助您監控網站，且費用不高。建議您註冊這類服務，確保您的網站安全無虞。</li>
</ul>

<a name="resources"></a>
<h2>其他資源</h2>
<p>如果您仍然無法順利修正網站問題，還有另一些資源可能對您有所幫助。</p>

<p>這些工具會掃描您的網站，並可能發現有問題的內容。除了 VirusTotal 以外，Google 並未針對這些工具提供支援。</p>

<p><a href="https://www.virustotal.com/" l10n-encrypted-href="+yh4nIlcln/5B9bKgkfEGM782VG+rd3m0a4VL0AU26M=">Virus Total</a>、<a href="https://aw-snap.info/">Aw-snap.info</a>、<a href="https://sitecheck.sucuri.net/" l10n-encrypted-href="onZPCmFW+G106sKkIlw02x6VPeWQ/7qXNFWdb9FQ4feq8/jN0Xzo+qPU1sKgelGh">Sucuri Site Check</a>、
<a href="https://www.quttera.com/">Quttera</a>：這些工具都能為您掃描網站，協助找出問題內容。提醒您，這些掃描工具不一定能判別所有類型的問題內容。</p>

<p>Google 另外提供了以下資源，可能對您有所幫助：</p>

<ul>
<li><a href="//support.google.com/webmasters/go/community" l10n-encrypted-href="+MnmPhXLuMxD2VLFLngQ0KArGd6SuOrIdKNhJ8TAfI9k4yrci9ag38FePALAXcE0">Google 網站管理員說明論壇</a></li>
<li><a href="/web/fundamentals/security/hacked/">網站遭到入侵時適用的 Google 網站管理員說明</a></li>
<li><a href="//safebrowsing.google.com/" l10n-encrypted-href="1ZOZ2H6Eo250Va95oXrumTbQA6KByQU0uWZ6m4BBYCY=">Google 安全瀏覽</a></li>
</ul>

<div class="alert">還有其他您認為可能實用的工具嗎？請<a href="https://docs.google.com/a/  google.com/forms/d/12iF45BaZuEgwn29A7DOW73rd1Hi_7NiAHCFWB3zMu0U/viewform" l10n-encrypted-href="voYeKygemXxQpSsj4TC5AfUbyuHWzoMwWwMBaPnMUvCB/+GeICZWcFPsNfkTA2yKrhrEkO/djoguK4tnJcrqXJ+wsE+tFKLdRQjytTrchinkpeA/GFKTKj/6rHbJmOv3qwUI9b2ZthvPFzCvc6kgQQ==">提供意見</a>，讓我們瞭解您的想法。</div>


</body></html>
