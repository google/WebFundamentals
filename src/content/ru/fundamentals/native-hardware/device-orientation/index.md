project_path: /web/_project.yaml
book_path: /web/fundamentals/_book.yaml
description: События движения и изменения ориентации мобильного устройства открывают доступ ко встроенному акселерометру, гироскопу и компасу

{# wf_updated_on: 2014-10-20 #}
{# wf_published_on: 2000-01-01 #}

# Ориентация устройства {: .page-title }

{% include "web/_shared/contributors/petelepage.html" %}


События движения и изменения ориентации мобильного устройства открывают доступ ко встроенному акселерометру, гироскопу и компасу

Эти события могут использоваться во многих целях; например, в играх для 
контроля за передвижениями персонажа либо для определения высоты прыжка 
героя. Если использовать эти события вместе с функцией геолокации, можно создать более точную 
пошаговую систему навигации или предоставить информацию о местонахождении магазина.

Note: <b>Особенно</b> тщательно следует принимать решения об использовании событий, связанных с движением или изменением ориентации мобильных устройств.  К сожалению, не все браузеры используют одну и ту же систему координат, и поэтому при одинаковых условиях они могут возвращать различные значения.

## В каком положении находится устройство?

Чтобы использовать данные, получаемые от событий изменения ориентации и движения устройства,
важно понимать суть предоставляемых значений.  

### Система земных координат

Система земных координат описывается значениями осей `X`, `Y` и `Z`, ориентация которых определяется 
направлением магнитного меридиана и силы тяжести.

<ul>
  <li>
    <b>X:</b> расположена в направлении запад-восток (направлена на восток).
  </li>
    <li>
    <b>Y:</b> расположена в направлении юг-север (направлена на север).
  </li>
    <li>
    <b>Z:</b> представляет собой вертикальное направление, перпендикулярное к земле
 (направлена вверх).
  </li>
</ul>

### Система координат устройства

Система координат устройства описывается значениями по осям `x`, `y` и `z`, которые исходят
из центра устройства.

<img src="images/axes.png" alt="Изображение системы координат устройства">
<!-- Особая благодарность выражается Sheppy (https://developer.mozilla.org/en-US/profiles/Sheppy) 
  за изображения, к которым был предоставлен свободный доступ. -->

<ul>
  <li>
    <b>x:</b> эта ось расположена в плоскости экрана и направлена вправо.
  </li>
    <li>
    <b>y:</b> эта ось расположена в плоскости экрана и направлена к его верхней части.
  </li>
    <li>
    <b>z:</b> эта ось расположена перпендикулярно экрану или клавиатуре и направлена
   наружу.
  </li>
</ul>

На телефоне или планшете ориентация устройства определяется по типичной
ориентации экрана.  На телефоне или планшете это 
положение в портретной ориентации. На персональных компьютерах или ноутбуках ориентация 
определяется по отношению к клавиатуре.

### Данные о повороте

Данные о повороте поступают как величина [угла Эйлера](http://en.wikipedia.org/wiki/Euler_angles),
представляющего собой разницу в градусах между координатами устройства
и земными координатами.

<div class="attempt-right">
  <figure id="fig1">
    <img src="images/alpha.png" alt="illustration of device coordinate frame">
    <b>альфа:</b> Угол поворота вокруг оси z = 0&deg;, когда верхняя часть
  устройства направлена точно на север.  При повороте устройства против часовой стрелки
    значение `alpha` увеличивается.
  </figure>
</div>

<div class="attempt-right">
  <figure id="fig1">
    <img src="images/beta.png" alt="illustration of device coordinate frame">
    <b>бета:</b> Угол поворота вокруг оси x = 0&deg;, когда верхняя и 
нижняя части устройства находятся на одинаковом расстоянии от земной поверхности. Значение
    увеличивается, когда верхнюю часть устройства наклоняют в направлении земной поверхности.
  </figure>
</div>

<div class="attempt-right">
  <figure id="fig1">
    <img src="images/gamma.png" alt="illustration of device coordinate frame">
    <b>гамма:</b> Угол поворота вокруг оси y = 0&deg;, когда левая и
 правая части устройства находятся на одинаковом расстоянии от земной поверхности.  Значение
    увеличивается, когда правую часть устройства наклоняют в направлении земной поверхности. 
  </figure>
</div>

<div style="clear:both;"></div>

## Ориентация устройства 


Событие 'изменение ориентации устройства' возвращает данные о повороте, такие как угол наклона устройства вперед-назад, из стороны в сторону и, если в телефоне или ноутбуке имеется компас, сведения о том, куда направлена лицевая сторона устройства.


#### TL;DR {: .hide-from-toc }
- Не используйте это событие слишком часто.
- Проверьте наличие поддержки.
- Не обновляйте интерфейс при каждом событии. Вместо этого выполняйте синхронизацию с <code>requestAnimationFrame</code>.


### Ситуации, в которых следует использовать события "изменение ориентации устройства"

Существует несколько ситуаций, в которых можно использовать события "изменение ориентации устройства".  Например:

<ul>
  <li>Обновление карты по мере перемещения пользователя.</li>
  <li>Тонкая настройка интерфейса, например добавление эффектов параллакса.</li>
  <li>В сочетании с возможностями геолокации можно использовать для пошаговой навигации.</li>
</ul>

### Проверка наличия поддержки и прием событий

Чтобы принимать события `DeviceOrientationEvent`, сначала проверьте, поддерживаются ли эти события
в браузере.  Затем подключите приемник событий к объекту `window`,
принимающему события `deviceorientation`. 

<pre class="prettyprint">
{% includecode content_path="web/fundamentals/native-hardware/device-orientation/_code/dev-orientation.html" region_tag="devori"   adjust_indentation="auto" %}
</pre>

### Обработка событий "изменение ориентации устройства"

Событие "изменение ориентации устройства" запускается при перемещении или изменении
ориентации устройства.  Событие возвращает данные об изменении текущего положения
устройства по отношению к <a href="index.html#earth-coordinate-frame">
системе земных координат</a>.

Обычно событие возвращает три свойства:
<a href="index.html#rotation-data">`alpha`</a>, 
<a href="index.html#rotation-data">`beta`</a> и
<a href="index.html#rotation-data">`gamma`</a>.  В браузере для мобильных устройств Mobile Safari возвращается
дополнительный параметр <a href="https://developer.apple.com/library/safari/documentation/SafariDOMAdditions/Reference/DeviceOrientationEventClassRef/DeviceOrientationEvent/DeviceOrientationEvent.html">`webkitCompassHeading`</a> с заголовком
"компас".




## Движение устройства 


Движение устройства дает информацию о силе ускорения, приложенной к устройству в данный момент, и о скорости вращения


#### TL;DR {: .hide-from-toc }
- Используйте движение устройства для случаев, когда требуется знать текущие характеристики перемещения устройства.
- значение скорости вращения <code>rotationRate</code> выражено в &deg;/сек.
- значения <code>acceleration</code> и <code>accelerationWithGravity</code> измеряются в м/сек<sup>2</sup>.
- Помните о разнице между вариантами браузеров.


### Ситуации, в которых следует использовать события "движение устройства"

Существует несколько ситуаций, в которых можно использовать события "движение устройства".  Например:

<ul>
  <li>Жест встряхивания для обновления данных.</li>
  <li>В играх, чтобы заставить персонажей прыгнуть или переместиться.</li>
  <li>В приложениях для здоровья и фитнеса</li>
</ul>

### Проверка поддержки и приема событий

Чтобы принимать события `DeviceMotionEvent`, сначала проверьте, поддерживаются ли эти события
в браузере.  Затем подключите приемник событий к объекту `window`,
принимающему события `devicemotion`. 

<pre class="prettyprint">
{% includecode content_path="web/fundamentals/native-hardware/device-orientation/_code/jump-test.html" region_tag="devmot"   adjust_indentation="auto" %}
</pre>

### Обработка событий "движение устройства"

Событие "движение устройства" запускается через регулярные интервалы и возвращает данные о
вращении (в &deg; в секунду) и ускорении (в м в секунду<sup>2</sup>)
, которые характеризуют перемещение устройства в данный момент времени.  В некоторых устройствах нет компонентов, которые позволяют 
не учитывать воздействие силы тяжести.

Событие возвращает четыре свойства, 
<a href="index.html#device-frame-coordinate">`accelerationIncludingGravity`</a>, 
<a href="index.html#device-frame-coordinate">`acceleration`</a>, 
в котором не учитывается воздействие силы тяжести, 
<a href="index.html#rotation-data">`rotationRate`</a> и `interval`.

Например, рассмотрим телефон, лежащий на горизонтальном столе
экраном вверх.

<table>
    <thead>
    <tr>
      <th data-th="State">Состояние</th>
      <th data-th="Rotation">Вращение</th>
      <th data-th="Acceleration (m/s<sup>2</sup>)">Ускорение (м/с<sup>2</sup>)</th>
      <th data-th="Acceleration with gravity (m/s<sup>2</sup>)">Ускорение с учетом силы тяжести (м/с<sup>2</sup>)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td data-th="State">Состояние покоя</td>
      <td data-th="Rotation">[0, 0, 0]</td>
      <td data-th="Acceleration">[0, 0, 0]</td>
      <td data-th="Acceleration with gravity">[0, 0, 9,8]</td>
    </tr>
    <tr>
      <td data-th="State">Движение вверх</td>
      <td data-th="Rotation">[0, 0, 0]</td>
      <td data-th="Acceleration">[0, 0, 5]</td>
      <td data-th="Acceleration with gravity">[0, 0, 14,81]</td>
    </tr>
    <tr>
      <td data-th="State">Движение только вправо</td>
      <td data-th="Rotation">[0, 0, 0]</td>
      <td data-th="Acceleration">[3, 0, 0]</td>
      <td data-th="Acceleration with gravity">[3, 0, 9,81]</td>
    </tr>
    <tr>
      <td data-th="State">Движение вверх и вправо</td>
      <td data-th="Rotation">[0, 0, 0]</td>
      <td data-th="Acceleration">[5, 0, 5]</td>
      <td data-th="Acceleration with gravity">[5, 0, 14,81]</td>
    </tr>
  </tbody>
</table>

В отличие от этого, если экран телефона расположен перпендикулярно к земле
и виден наблюдателю:

<table>
    <thead>
    <tr>
      <th data-th="State">Состояние</th>
      <th data-th="Rotation">Вращение</th>
      <th data-th="Acceleration (m/s<sup>2</sup>)">Ускорение (м/с<sup>2</sup>)</th>
      <th data-th="Acceleration with gravity (m/s<sup>2</sup>)">Ускорение с учетом силы тяжести (м/с<sup>2</sup>)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td data-th="State">Состояние покоя</td>
      <td data-th="Rotation">[0, 0, 0]</td>
      <td data-th="Acceleration">[0, 0, 0]</td>
      <td data-th="Acceleration with gravity">[0, 9,81, 0]</td>
    </tr>
    <tr>
      <td data-th="State">Движение вверх</td>
      <td data-th="Rotation">[0, 0, 0]</td>
      <td data-th="Acceleration">[0, 5, 0]</td>
      <td data-th="Acceleration with gravity">[0, 14,81, 0]</td>
    </tr>
    <tr>
      <td data-th="State">Движение только вправо</td>
      <td data-th="Rotation">[0, 0, 0]</td>
      <td data-th="Acceleration">[3, 0, 0]</td>
      <td data-th="Acceleration with gravity">[3, 9,81, 0]</td>
    </tr>
    <tr>
      <td data-th="State">Движение вверх и вправо</td>
      <td data-th="Rotation">[0, 0, 0]</td>
      <td data-th="Acceleration">[5, 5, 0]</td>
      <td data-th="Acceleration with gravity">[5, 14,81, 0]</td>
    </tr>
  </tbody>
</table>

#### Пример. Расчет максимального ускорения объекта

Один из способов использовать события "движение устройства" — вычисление максимального
ускорения объекта.  Например, можно рассчитать максимальное ускорение
человека в прыжке.

<pre class="prettyprint">
{% includecode content_path="web/fundamentals/native-hardware/device-orientation/_code/jump-test.html" region_tag="devmothand"   adjust_indentation="auto" %}
</pre>

После касания кнопки Go! пользователю предлагается подпрыгнуть!  В течение этого времени
на странице сохраняются значения максимального (и минимального) ускорения, а после прыжка
 сообщается максимальное ускорение пользователя.

