project_path: /web/_project.yaml
book_path: /web/fundamentals/_book.yaml

{# wf_updated_on: 2015-03-26 #}
{# wf_published_on: 2000-01-01 #}

# Включение строгой безопасности транспорта и использование защищенных файлов cookie {: .page-title }

{% include "web/_shared/contributors/chrispalmer.html" %}
{% include "web/_shared/contributors/mattgaunt.html" %}


### TL;DR {: .hide-from-toc }
- Необходимо использовать механизм HTTP Strict Transport Security (HSTS), чтобы избежать затрат, связанных с кодом перенаправления 301.
- Всегда устанавливайте флаг Secure для файлов cookie.



На этом этапе мы уже "зафиксировали" использование протокола HTTPS. Сначала воспользуйтесь [механизмом Strict 
Transport 
Security](https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security), чтобы указать клиентам, 
что для подключения к вашему серверу следует всегда использовать протокол HTTPS, даже при переходе по ссылке http://.
 Это позволит защититься от атак типа [SSL
Strip](http://www.thoughtcrime.org/software/sslstrip/){: .external }, а также избежать 
затрат, связанных с кодом перенаправления 301, о чем мы рассказали в разделе "Перенаправление с HTTP на HTTPS".

**ПРИМЕЧАНИЕ.** Существует высокая вероятность, что у клиентов, которые отметили ваш сайт как известный узел HSTS, 
возникнет серьезный сбой](https://tools.ietf.org/html/rfc6797#section-12.1), _[если в конфигурации TLS
](https://tools.ietf.org/html/rfc6797#section-12.1)[ вашего сайта имеется ошибка
](https://tools.ietf.org/html/rfc6797#section-12.1) (например, 
просроченный сертификат). Такое поведение явным образом задано в самом механизме HSTS; это 
позволяет гарантировать, что злоумышленники не смогут обмануть клиентов, заставив их перейти на 
сайт по незащищенному протоколу. Не включайте HSTS, пока тщательно не проработаете ваш 
сайт, чтобы избежать развертывания HTTPS с ошибками 
проверки сертификата.

Чтобы включить механизм HSTS, задайте заголовок Strict-Transport-Security.
 [На странице OWASP, посвященной HSTS, имеются ссылки на 
соответствующие инструкции](https://www.owasp.org/index.php/HTTP_Strict_Transport_Security) 
для различного серверного ПО.

Большинство веб-серверов оснащены аналогичной функцией добавления настраиваемых заголовков.

**ПРИМЕЧАНИЕ.** Значение параметра "max-age" задается в секундах. Для начала можно указать небольшие значения,
а затем постепенно увеличивать значение параметра "max-age" по мере более уверенного перехода на использование только
HTTPS для своего сайта.

Также важно обеспечить, чтобы клиенты никогда не отправляли файлы cookie (например, для
аутентификации или передачи настроек сайта) по протоколу HTTP. Например, если
файл cookie пользователя с данными аутентификации представлен в виде обычного текста, безопасность всего 
сеанса подключения гарантированно будет нарушена, даже если все остальное было сделано
правильно.

Поэтому ваше приложение должно всегда устанавливать флаг Secure
для файлов cookie. [На этой странице OWASP поясняется, каким образом флаг
Secure](https://www.owasp.org/index.php/SecureFlag) устанавливается в ряде платформ приложений.
 В каждой платформе приложений имеется способ установить такой флаг.

